import pytest
from pioneer.features import *

"""
def test_calculate_expasy():
    seq_dict = {'P01112':'MTEYKLVVVGAGGVGKSALTIQLIQNHFVDEYDPTIEDSYRKQVVIDGETCLLDILDTAGQEEYSAMRDQYMRTGEGFLCVFAINNTKSFEDIHQYREQIKRVKDSDDVPMVLVGNKCDLAARTVESRQAQDLARSYGIPYIETSAKTRQGVEDAFYTLVREIRQHKLRKLNPPDESGPGCMSCKCVLS','P04637':'MEEPQSDPSVEPPLSQETFSDLWKLLPENNVLSPLPSQAMDDLMLSPDDIEQWFTEDPGPDEAPRMPEAAPPVAPAPAAPTPAAPAPAPSWPLSSSVPSQKTYQGSYGFRLGFLHSGTAKSVTCTYSPALNKMFCQLAKTCPVQLWVDSTPPPGTRVRAMAIYKQSQHMTEVVRRCPHHERCSDSDGLAPPQHLIRVEGNLRVEYLDDRNTFRHSVVVPYEPPEVGSDCTTIHYNYMCNSSCMGGMNRRPILTIITLEDSSGNLLGRNSFEVRVCACPGRDRRTEEENLRKKGEPHHELPPGSTKRALPNNTSSSPQPKKKPLDGEYFTLQIRGRERFEMFRELNEALELKDAQAGKEPGGSRAHSSHLKSKKGQSTSRHKKLMFKTEGPDSD', 'P39351':'MLPPGPLLVLPVGARVSRGGLSPTERSCISRHTQQYLRACYPSGRYGTKGLVVRWFTGGREPRGTDNEPSGNRSLEPHAWLTDVLTRLPEWPEERLAELLPLEGFTFFG', 'P75679':'MICSPQNNTGVIMKKRNFSAEFKRESAQLVVDQNYTVADAASAMDVGLSTMTRWVKQLRDERQGKTPKASPITPEQIEIRELRKKLQRIEMENEILKKATVDSIGQRNSYVKTWGCGGFLNETNIYSRGKSLCF'}
    print(calculate_expasy(seq_dict))


def test_calculate_conservation():
    seq_dict = {'P01112':'MTEYKLVVVGAGGVGKSALTIQLIQNHFVDEYDPTIEDSYRKQVVIDGETCLLDILDTAGQEEYSAMRDQYMRTGEGFLCVFAINNTKSFEDIHQYREQIKRVKDSDDVPMVLVGNKCDLAARTVESRQAQDLARSYGIPYIETSAKTRQGVEDAFYTLVREIRQHKLRKLNPPDESGPGCMSCKCVLS','P04637':'MEEPQSDPSVEPPLSQETFSDLWKLLPENNVLSPLPSQAMDDLMLSPDDIEQWFTEDPGPDEAPRMPEAAPPVAPAPAAPTPAAPAPAPSWPLSSSVPSQKTYQGSYGFRLGFLHSGTAKSVTCTYSPALNKMFCQLAKTCPVQLWVDSTPPPGTRVRAMAIYKQSQHMTEVVRRCPHHERCSDSDGLAPPQHLIRVEGNLRVEYLDDRNTFRHSVVVPYEPPEVGSDCTTIHYNYMCNSSCMGGMNRRPILTIITLEDSSGNLLGRNSFEVRVCACPGRDRRTEEENLRKKGEPHHELPPGSTKRALPNNTSSSPQPKKKPLDGEYFTLQIRGRERFEMFRELNEALELKDAQAGKEPGGSRAHSSHLKSKKGQSTSRHKKLMFKTEGPDSD', 'P39351':'MLPPGPLLVLPVGARVSRGGLSPTERSCISRHTQQYLRACYPSGRYGTKGLVVRWFTGGREPRGTDNEPSGNRSLEPHAWLTDVLTRLPEWPEERLAELLPLEGFTFFG', 'P75679':'MICSPQNNTGVIMKKRNFSAEFKRESAQLVVDQNYTVADAASAMDVGLSTMTRWVKQLRDERQGKTPKASPITPEQIEIRELRKKLQRIEMENEILKKATVDSIGQRNSYVKTWGCGGFLNETNIYSRGKSLCF'}
    print(calculate_conservation(seq_dict))


def test_calculate_coevolution():
    int_list = [('P01112', 'P04637'), ('P39351', 'P75679')]
    seq_dict = {'P01112':'MTEYKLVVVGAGGVGKSALTIQLIQNHFVDEYDPTIEDSYRKQVVIDGETCLLDILDTAGQEEYSAMRDQYMRTGEGFLCVFAINNTKSFEDIHQYREQIKRVKDSDDVPMVLVGNKCDLAARTVESRQAQDLARSYGIPYIETSAKTRQGVEDAFYTLVREIRQHKLRKLNPPDESGPGCMSCKCVLS','P04637':'MEEPQSDPSVEPPLSQETFSDLWKLLPENNVLSPLPSQAMDDLMLSPDDIEQWFTEDPGPDEAPRMPEAAPPVAPAPAAPTPAAPAPAPSWPLSSSVPSQKTYQGSYGFRLGFLHSGTAKSVTCTYSPALNKMFCQLAKTCPVQLWVDSTPPPGTRVRAMAIYKQSQHMTEVVRRCPHHERCSDSDGLAPPQHLIRVEGNLRVEYLDDRNTFRHSVVVPYEPPEVGSDCTTIHYNYMCNSSCMGGMNRRPILTIITLEDSSGNLLGRNSFEVRVCACPGRDRRTEEENLRKKGEPHHELPPGSTKRALPNNTSSSPQPKKKPLDGEYFTLQIRGRERFEMFRELNEALELKDAQAGKEPGGSRAHSSHLKSKKGQSTSRHKKLMFKTEGPDSD', 'P39351':'MLPPGPLLVLPVGARVSRGGLSPTERSCISRHTQQYLRACYPSGRYGTKGLVVRWFTGGREPRGTDNEPSGNRSLEPHAWLTDVLTRLPEWPEERLAELLPLEGFTFFG', 'P75679':'MICSPQNNTGVIMKKRNFSAEFKRESAQLVVDQNYTVADAASAMDVGLSTMTRWVKQLRDERQGKTPKASPITPEQIEIRELRKKLQRIEMENEILKKATVDSIGQRNSYVKTWGCGGFLNETNIYSRGKSLCF'}
    print(calculate_coevolution(int_list, seq_dict))


def test_calculate_sasa():
    int_list = [('P09211', 'Q9H0R8'), ('P84101', 'Q9NW08')]
    seq_dict = {'P09211':'MPPYTVVYFPVRGRCAALRMLLADQGQSWKEEVVTVETWQEGSLKASCLYGQLPKFQDGDLTLYQSNTILRHLGRTLGLYGKDQQEAALVDMVNDGVEDLRCKYISLIYTNYEAGKDDYVKALPGQLKPFETLLSQNQGGKTFIVGDQISFADYNLLDLLLIHEVLAPGCLDAFPLLSAYVGRLSARPKLKAFLASPEYVNLPINGNGKQ','Q9H0R8':'MKFQYKEDHPFEYRKKEGEKIRKKYPDRVPVIVEKAPKARVPDLDKRKYLVPSDLTVGQFYFLIRKRIHLRPEDALFFFVNNTIPPTSATMGQLYEDNHEEDYFLYVAYSDESVYGK', 'P84101':'MTRGNQRELARQKNMKKQSDSVKGKRRDDGLSAAARKQRDSEIMQQKQKKANEKKEEPK', 'Q9NW08':'MDVLAEEFGNLTPEQLAAPIPTVEEKWRLLPAFLKVKGLVKQHIDSFNYFINVEIKKIMKANEKVTSDADPMWYLKYLNIYVGLPDVEESFNVTRPVSPHECRLRDMTYSAPITVDIEYTRGSQRIIRNALPIGRMPIMLRSSNCVLTGKTPAEFAKLNECPLDPGGYFIVKGVEKVILIQEQLSKNRIIVEADRKGAVGASVTSSTHEKKSRTNMAVKQGRFYLRHNTLSEDIPIVIIFKAMGVESDQEIVQMIGTEEHVMAAFGPSLEECQKAQIFTQMQALKYIGNKVRRQRMWGGGPKKTKIEEARELLASTILTHVPVKEFNFRAKCIYTAVMVRRVILAQGDNKVDDRDYYGNKRLELAGQLLSLLFEDLFKKFNSEMKKIADQVIPKQRAAQFDVVKHMRQDQITNGMVNAISTGNWSLKRFKMDRQGVTQVLSRLSYISALGMMTRISSQFEKTRKVSGPRSLQPSQWGMLCPSDTPEGEACGLVKNLALMTHITTDMEDGPIVKLASNLGVEDVNLLCGEELSYPNVFLVFLNGNILGVIRDHKKLVNTFRLMRRAGYINEFVSISTNLTDRCVYISSDGGRLCRPYIIVKKQKPAVTNKHMEELAQGYRNFEDFLHESLVEYLDVNEENDCNIALYEHTINKDTTHLEIEPFTLLGVCAGLIPYPHHNQSPRNTYQCAMGKQAMGTIGYNQRNRIDTLMYLLAYPQKPMVKTKTIELIEFEKLPAGQNATVAVMSYSGYDIEDALVLNKASLDRGFGRCLVYKNAKCTLKRYTNQTFDKVMGPMLDAATRKPIWRHEILDADGICSPGEKVENKQVLVNKSMPTVTQIPLEGSNVPQQPQYKDVPITYKGATDSYIEKVMISSNAEDAFLIKMLLRQTRRPEIGDKFSSRHGQKGVCGLIVPQEDMPFCDSGICPDIIMNPHGFPSRMTVGKLIELLAGKAGVLDGRFHYGTAFGGSKVKDVCEDLVRHGYNYLGKDYVTSGITGEPLEAYIYFGPVYYQKLKHMVLDKMHARARGPRAVLTRQPTEGRSRDGGLRLGEMERDCLIGYGASMLLLERLMISSDAFEVDVCGQCGLLGYSGWCHYCKSSCHVSSLRIPYACKLLFQELQSMNIIPRLKLSKYNE'}
    print(calculate_sasa(int_list, seq_dict, defaultdict(set)))


def test_calculate_zdock():
    int_list = [('P09211', 'Q9H0R8'), ('P84101', 'Q9NW08')]
    seq_dict = {'P09211':'MPPYTVVYFPVRGRCAALRMLLADQGQSWKEEVVTVETWQEGSLKASCLYGQLPKFQDGDLTLYQSNTILRHLGRTLGLYGKDQQEAALVDMVNDGVEDLRCKYISLIYTNYEAGKDDYVKALPGQLKPFETLLSQNQGGKTFIVGDQISFADYNLLDLLLIHEVLAPGCLDAFPLLSAYVGRLSARPKLKAFLASPEYVNLPINGNGKQ','Q9H0R8':'MKFQYKEDHPFEYRKKEGEKIRKKYPDRVPVIVEKAPKARVPDLDKRKYLVPSDLTVGQFYFLIRKRIHLRPEDALFFFVNNTIPPTSATMGQLYEDNHEEDYFLYVAYSDESVYGK', 'P84101':'MTRGNQRELARQKNMKKQSDSVKGKRRDDGLSAAARKQRDSEIMQQKQKKANEKKEEPK', 'Q9NW08':'MDVLAEEFGNLTPEQLAAPIPTVEEKWRLLPAFLKVKGLVKQHIDSFNYFINVEIKKIMKANEKVTSDADPMWYLKYLNIYVGLPDVEESFNVTRPVSPHECRLRDMTYSAPITVDIEYTRGSQRIIRNALPIGRMPIMLRSSNCVLTGKTPAEFAKLNECPLDPGGYFIVKGVEKVILIQEQLSKNRIIVEADRKGAVGASVTSSTHEKKSRTNMAVKQGRFYLRHNTLSEDIPIVIIFKAMGVESDQEIVQMIGTEEHVMAAFGPSLEECQKAQIFTQMQALKYIGNKVRRQRMWGGGPKKTKIEEARELLASTILTHVPVKEFNFRAKCIYTAVMVRRVILAQGDNKVDDRDYYGNKRLELAGQLLSLLFEDLFKKFNSEMKKIADQVIPKQRAAQFDVVKHMRQDQITNGMVNAISTGNWSLKRFKMDRQGVTQVLSRLSYISALGMMTRISSQFEKTRKVSGPRSLQPSQWGMLCPSDTPEGEACGLVKNLALMTHITTDMEDGPIVKLASNLGVEDVNLLCGEELSYPNVFLVFLNGNILGVIRDHKKLVNTFRLMRRAGYINEFVSISTNLTDRCVYISSDGGRLCRPYIIVKKQKPAVTNKHMEELAQGYRNFEDFLHESLVEYLDVNEENDCNIALYEHTINKDTTHLEIEPFTLLGVCAGLIPYPHHNQSPRNTYQCAMGKQAMGTIGYNQRNRIDTLMYLLAYPQKPMVKTKTIELIEFEKLPAGQNATVAVMSYSGYDIEDALVLNKASLDRGFGRCLVYKNAKCTLKRYTNQTFDKVMGPMLDAATRKPIWRHEILDADGICSPGEKVENKQVLVNKSMPTVTQIPLEGSNVPQQPQYKDVPITYKGATDSYIEKVMISSNAEDAFLIKMLLRQTRRPEIGDKFSSRHGQKGVCGLIVPQEDMPFCDSGICPDIIMNPHGFPSRMTVGKLIELLAGKAGVLDGRFHYGTAFGGSKVKDVCEDLVRHGYNYLGKDYVTSGITGEPLEAYIYFGPVYYQKLKHMVLDKMHARARGPRAVLTRQPTEGRSRDGGLRLGEMERDCLIGYGASMLLLERLMISSDAFEVDVCGQCGLLGYSGWCHYCKSSCHVSSLRIPYACKLLFQELQSMNIIPRLKLSKYNE'}
    print(calculate_zdock(int_list, seq_dict, defaultdict(set)))
"""

def test_calculate_raptorX():
    seq_dict = {'P09211':'MPPYTVVYFPVRGRCAALRMLLADQGQSWKEEVVTVETWQEGSLKASCLYGQLPKFQDGDLTLYQSNTILRHLGRTLGLYGKDQQEAALVDMVNDGVEDLRCKYISLIYTNYEAGKDDYVKALPGQLKPFETLLSQNQGGKTFIVGDQISFADYNLLDLLLIHEVLAPGCLDAFPLLSAYVGRLSARPKLKAFLASPEYVNLPINGNGKQ','Q9H0R8':'MKFQYKEDHPFEYRKKEGEKIRKKYPDRVPVIVEKAPKARVPDLDKRKYLVPSDLTVGQFYFLIRKRIHLRPEDALFFFVNNTIPPTSATMGQLYEDNHEEDYFLYVAYSDESVYGK', 'P84101':'MTRGNQRELARQKNMKKQSDSVKGKRRDDGLSAAARKQRDSEIMQQKQKKANEKKEEPK'}
    print(calculate_raptorX(seq_dict))

"""
def test_calculate_pair_potential():
    int_list = [('P09211', 'Q9H0R8'), ('P84101', 'Q9NW08')]
    seq_dict = {'P09211':'MPPYTVVYFPVRGRCAALRMLLADQGQSWKEEVVTVETWQEGSLKASCLYGQLPKFQDGDLTLYQSNTILRHLGRTLGLYGKDQQEAALVDMVNDGVEDLRCKYISLIYTNYEAGKDDYVKALPGQLKPFETLLSQNQGGKTFIVGDQISFADYNLLDLLLIHEVLAPGCLDAFPLLSAYVGRLSARPKLKAFLASPEYVNLPINGNGKQ','Q9H0R8':'MKFQYKEDHPFEYRKKEGEKIRKKYPDRVPVIVEKAPKARVPDLDKRKYLVPSDLTVGQFYFLIRKRIHLRPEDALFFFVNNTIPPTSATMGQLYEDNHEEDYFLYVAYSDESVYGK', 'P84101':'MTRGNQRELARQKNMKKQSDSVKGKRRDDGLSAAARKQRDSEIMQQKQKKANEKKEEPK', 'Q9NW08':'MDVLAEEFGNLTPEQLAAPIPTVEEKWRLLPAFLKVKGLVKQHIDSFNYFINVEIKKIMKANEKVTSDADPMWYLKYLNIYVGLPDVEESFNVTRPVSPHECRLRDMTYSAPITVDIEYTRGSQRIIRNALPIGRMPIMLRSSNCVLTGKTPAEFAKLNECPLDPGGYFIVKGVEKVILIQEQLSKNRIIVEADRKGAVGASVTSSTHEKKSRTNMAVKQGRFYLRHNTLSEDIPIVIIFKAMGVESDQEIVQMIGTEEHVMAAFGPSLEECQKAQIFTQMQALKYIGNKVRRQRMWGGGPKKTKIEEARELLASTILTHVPVKEFNFRAKCIYTAVMVRRVILAQGDNKVDDRDYYGNKRLELAGQLLSLLFEDLFKKFNSEMKKIADQVIPKQRAAQFDVVKHMRQDQITNGMVNAISTGNWSLKRFKMDRQGVTQVLSRLSYISALGMMTRISSQFEKTRKVSGPRSLQPSQWGMLCPSDTPEGEACGLVKNLALMTHITTDMEDGPIVKLASNLGVEDVNLLCGEELSYPNVFLVFLNGNILGVIRDHKKLVNTFRLMRRAGYINEFVSISTNLTDRCVYISSDGGRLCRPYIIVKKQKPAVTNKHMEELAQGYRNFEDFLHESLVEYLDVNEENDCNIALYEHTINKDTTHLEIEPFTLLGVCAGLIPYPHHNQSPRNTYQCAMGKQAMGTIGYNQRNRIDTLMYLLAYPQKPMVKTKTIELIEFEKLPAGQNATVAVMSYSGYDIEDALVLNKASLDRGFGRCLVYKNAKCTLKRYTNQTFDKVMGPMLDAATRKPIWRHEILDADGICSPGEKVENKQVLVNKSMPTVTQIPLEGSNVPQQPQYKDVPITYKGATDSYIEKVMISSNAEDAFLIKMLLRQTRRPEIGDKFSSRHGQKGVCGLIVPQEDMPFCDSGICPDIIMNPHGFPSRMTVGKLIELLAGKAGVLDGRFHYGTAFGGSKVKDVCEDLVRHGYNYLGKDYVTSGITGEPLEAYIYFGPVYYQKLKHMVLDKMHARARGPRAVLTRQPTEGRSRDGGLRLGEMERDCLIGYGASMLLLERLMISSDAFEVDVCGQCGLLGYSGWCHYCKSSCHVSSLRIPYACKLLFQELQSMNIIPRLKLSKYNE'}
    print(calculate_pair_potential(int_list, seq_dict))
"""